<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>AR Darshan</title>
    <style>
      body {
        margin: 0;
        font-family: Arial, sans-serif;
        background-color: #f0f0f0;
        text-align: center;
      }
      header {
        background-color: #4CAF50;
        color: white;
        padding: 1em 0;
      }
      h1 {
        margin: 0;
      }
      main {
        padding: 1em;
      }
      #canhazwebxr {
        margin-top: 1em;
        font-size: 1.1em;
      }
      #canhazimg {
        width: 32px;
        vertical-align: middle;
      }
      button {
        padding: 1em 2em;
        font-size: 1em;
        margin-top: 2em;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <header>
      <h1>AR Darshan</h1>
      <p>Experience Augmented Reality</p>
    </header>

    <main>
      <img id="canhazimg" alt="">
      <p id="canhazwebxr"></p>

      <button id="start-ar" style="display:none;">Start AR Experience</button>
    </main>

    <script>
      function isMobile(global) {
        return /Android|iPhone|iPad|iPod|Opera Mini|IEMobile|WPDesktop/i.test(global.navigator.userAgent);
      }

      let canhazElement = document.getElementById('canhazwebxr');
      let canhazImg = document.getElementById('canhazimg');
      let startButton = document.getElementById('start-ar');

      if ('xr' in navigator) {
        canhazElement.innerText = "Your device may support WebXR AR experiences.";
        navigator.xr.isSessionSupported('immersive-ar').then((supported) => {
          const span = document.createElement('span');
          span.innerText = supported ? '✔️ AR support detected' : '❌ AR support not detected';
          canhazElement.appendChild(document.createElement('br'));
          canhazElement.appendChild(span);

          if(supported) {
            startButton.style.display = 'inline-block';
          }
        });
        canhazImg.src = "media/textures/check-button.png";
      } else if (isMobile(window)) {
        canhazElement.innerText = "Your device does not support WebXR.";
        canhazImg.src = "media/textures/info-button.png";
      } else {
        canhazElement.innerText = "Sorry, your browser does not support WebXR.";
        canhazImg.src = "media/textures/x-button.png";
      }

      startButton.addEventListener('click', async () => {
        try {
          const session = await navigator.xr.requestSession('immersive-ar', {
            requiredFeatures: ['local']
          });
          alert('AR Session started! Implement your AR rendering logic here.');
          // Here you can add your WebXR AR rendering using Three.js or raw WebGL
        } catch(e) {
          alert('Failed to start AR session: ' + e);
        }
      });
    </script>
  </body>
</html>
